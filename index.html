<!DOCTYPE html>
<html lang="pt-BR" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale-1.0">
    <title>Projeto para BatchHacks</title>
    <!-- Carrega o Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Carrega a fonte Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Carrega a D3.js (para o Mapa de Calor) -->
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <!-- Configura√ß√£o do Tailwind e Estilos Personalizados -->
    <script>
        tailwind.config = {
            darkMode: 'class', // Ativa o modo escuro
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'], // Define 'Inter' como a fonte padr√£o
                    },
                    colors: {
                        'brand-primary': '#0A0A0A', // Um preto profundo para o fundo
                        'brand-secondary': '#F5F5F5', // Um branco suave para o texto
                        'brand-accent': '#3B82F6', // Um azul vibrante para destaques
                    }
                },
            },
        }
    </script>
    
    <style>
        /* Estilos personalizados leves */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0A0A0A; /* Fundo escuro padr√£o */
            color: #F5F5F5; /* Texto claro padr√£o */
        }
        .gradient-text {
            background: linear-gradient(to right, #3B82F6, #8B5CF6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .card-hover {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 20px rgba(59, 130, 246, 0.1);
        }

        /* Estilos do Modal */
        #project-modal-content {
            max-height: 80vh;
            overflow-y: auto;
        }

        /* Estilos do Jogo (Canvas) */
        #game-canvas {
            background-color: #000;
            border-radius: 8px;
            display: block; /* Remove espa√ßo extra abaixo do canvas */
            margin: 0 auto; /* Centraliza o canvas */
        }

        /* Estilos do Mapa de Calor (SVG) */
        #heatmap-svg {
            background-color: #1a1a1a;
            border-radius: 8px;
        }
    </style>
</head>
<body class="min-h-screen antialiased">

    <!-- Wrapper Principal -->
    <div class="container mx-auto max-w-5xl p-6">

        <!-- Cabe√ßalho -->
        <header class="flex justify-between items-center py-4 mb-12">
            <div class="text-xl font-bold">
                <span class="gradient-text">MeuProjeto</span>
            </div>
            <nav>
                <a href="#sobre" class="text-gray-400 hover:text-white px-3 py-2 rounded-md">Sobre</a>
                <a href="#projetos" class="text-gray-400 hover:text-white px-3 py-2 rounded-md">Projetos</a>
                <a href="#contato" class="text-gray-400 hover:text-white px-3 py-2 rounded-md">Contato</a>
            </nav>
        </header>

        <!-- Se√ß√£o Hero -->
        <main>
            <section class="text-center mb-24">
                <h1 class="text-5xl md:text-6xl font-bold mb-6">
                    Bem-vindo ao <span class="gradient-text">Projeto 404</span>
                </h1>
                <p class="text-xl text-gray-400 mb-8 max-w-2xl mx-auto">
                    Uma cole√ß√£o de experimentos e c√≥digos criados para o hackathon BatchHacks.
                </p>
                <a href="#projetos" class="bg-brand-accent text-white font-semibold px-8 py-3 rounded-lg shadow-lg shadow-blue-500/30 hover:bg-blue-600 transition-colors duration-300">
                    Ver Experimentos
                </a>
            </section>

            <!-- Se√ß√£o Sobre o Hackathon -->
            <section id="sobre" class="mb-24 p-8 bg-gray-900/50 border border-gray-800 rounded-xl">
                <!-- ... (conte√∫do 'sobre' existente) ... -->
                <h2 class="text-3xl font-bold mb-4">Sobre o Hackathon</h2>
                <p class="text-gray-400 mb-4">
                    Este projeto √© uma submiss√£o para o <strong class="text-white">BatchHacks</strong>, uma maratona de programa√ß√£o aberta para estudantes.
                </p>
                <blockquote class="border-l-4 border-brand-accent pl-4 italic text-gray-300 mb-4">
                    "Os participantes podem submeter qualquer coisa relacionada a c√≥digo que desejarem, desde aprendizado de m√°quina e visualiza√ß√£o de dados at√© jogos."
                </blockquote>
                <p class="text-sm text-gray-500">
                    O hackathon "O 404 Found" √© patrocinado e apresentado pela Batch 09.
                </p>
            </section>

            <!-- Se√ß√£o de Projetos (Grid) -->
            <section id="projetos" class="mb-24">
                <h2 class="text-3xl font-bold mb-8 text-center">Meus Experimentos</h2>
                <div class="grid md:grid-cols-2 gap-8">
                    
                    <!-- Card de Projeto 1 -->
                    <div class="bg-gray-900/50 border border-gray-800 p-6 rounded-xl card-hover flex flex-col">
                        <div class="mb-3">
                            <span class="text-xs font-semibold px-3 py-1 bg-blue-600/20 text-blue-300 rounded-full">Machine Learning</span>
                        </div>
                        <h3 class="text-2xl font-bold mb-3">Analisador de Sentimento</h3>
                        <p class="text-gray-400 mb-4 flex-grow">
                            Um modelo *simulado* de ML para classificar o sentimento de textos curtos.
                        </p>
                        <!-- BOT√ÉO para abrir o modal -->
                        <button onclick="openProjectModal('sentiment')" class="mt-auto w-full text-center font-semibold text-brand-accent hover:underline">
                            Testar Agora &rarr;
                        </button>
                    </div>
                    
                    <!-- Card de Projeto 2 -->
                    <div class="bg-gray-900/50 border border-gray-800 p-6 rounded-xl card-hover flex flex-col">
                        <div class="mb-3">
                            <span class="text-xs font-semibold px-3 py-1 bg-purple-600/20 text-purple-300 rounded-full">Visualiza√ß√£o com IA</span>
                        </div>
                        <h3 class="text-2xl font-bold mb-3">Criador de Gr√°ficos (IA)</h3>
                        <p class="text-gray-400 mb-4 flex-grow">
                            Descreva um conjunto de dados e a IA ir√° gerar um gr√°fico para voc√™.
                        </p>
                        <!-- BOT√ÉO para abrir o modal -->
                        <button onclick="openProjectModal('aiChartGenerator')" class="mt-auto w-full text-center font-semibold text-brand-accent hover:underline">
                            Testar Agora &rarr;
                        </button>
                    </div>

                    <!-- Card de Projeto 3 -->
                    <div class="bg-gray-900/50 border border-gray-800 p-6 rounded-xl card-hover flex flex-col">
                        <div class="mb-3">
                            <span class="text-xs font-semibold px-3 py-1 bg-green-600/20 text-green-300 rounded-full">Web Game</span>
                        </div>
                        <h3 class="text-2xl font-bold mb-3">Space Invaders HTML5</h3>
                        <p class="text-gray-400 mb-4 flex-grow">
                            Um clone b√°sico do cl√°ssico jogo de arcade feito com JavaScript puro.
                        </p>
                        <!-- BOT√ÉO para abrir o modal -->
                        <button onclick="openProjectModal('spaceInvaders')" class="mt-auto w-full text-center font-semibold text-brand-accent hover:underline">
                            Jogar Agora &rarr;
                        </button>
                    </div>

                    <!-- Card "Em Breve" (7 deles para totalizar 10) -->
                    <!-- Card de Projeto 4 -->
                    <div class="bg-gray-900/50 border border-gray-800 p-6 rounded-xl card-hover flex flex-col">
                        <div class="mb-3">
                            <span class="text-xs font-semibold px-3 py-1 bg-red-600/20 text-red-300 rounded-full">Design com IA</span>
                        </div>
                        <h3 class="text-2xl font-bold mb-3">Gerador de Paleta (IA)</h3>
                        <p class="text-gray-400 mb-4 flex-grow">
                            Descreva um tema e a IA criar√° uma paleta de cores (ex: "floresta tropical").
                        </p>
                        <button onclick="openProjectModal('paletteGenerator')" class="mt-auto w-full text-center font-semibold text-brand-accent hover:underline">
                            Gerar Cores &rarr;
                        </button>
                    </div>

                    <!-- Card de Projeto 5 -->
                    <div class="bg-gray-900/50 border border-gray-800 p-6 rounded-xl card-hover flex flex-col">
                        <div class="mb-3">
                            <span class="text-xs font-semibold px-3 py-1 bg-yellow-600/20 text-yellow-300 rounded-full">Jogo Cl√°ssico</span>
                        </div>
                        <h3 class="text-2xl font-bold mb-3">Jogo da Velha (IA)</h3>
                        <p class="text-gray-400 mb-4 flex-grow">
                            Tente vencer o computador no cl√°ssico jogo da velha.
                        </p>
                        <button onclick="openProjectModal('ticTacToe')" class="mt-auto w-full text-center font-semibold text-brand-accent hover:underline">
                            Jogar Agora &rarr;
                        </button>
                    </div>

                    <!-- Card de Projeto 6 -->
                    <div class="bg-gray-900/50 border border-gray-800 p-6 rounded-xl card-hover flex flex-col">
                        <div class="mb-3">
                            <span class="text-xs font-semibold px-3 py-1 bg-purple-600/20 text-purple-300 rounded-full">Visualiza√ß√£o (D3)</span>
                        </div>
                        <h3 class="text-2xl font-bold mb-3">Simulador de For√ßas</h3>
                        <p class="text-gray-400 mb-4 flex-grow">
                            Uma visualiza√ß√£o D3 interativa de n√≥s e links. Arraste os n√≥s.
                        </p>
                        <button onclick="openProjectModal('forceGraph')" class="mt-auto w-full text-center font-semibold text-brand-accent hover:underline">
                            Ver Demo &rarr;
                        </button>
                    </div>

                    <!-- Card de Projeto 7 -->
                    <div class="bg-gray-900/50 border border-gray-800 p-6 rounded-xl card-hover flex flex-col">
                        <div class="mb-3">
                            <span class="text-xs font-semibold px-3 py-1 bg-gray-500/20 text-gray-300 rounded-full">Utilit√°rio</span>
                        </div>
                        <h3 class="text-2xl font-bold mb-3">Editor Markdown</h3>
                        <p class="text-gray-400 mb-4 flex-grow">
                            Escreva em Markdown e veja o HTML renderizado em tempo real.
                        </p>
                        <button onclick="openProjectModal('markdownEditor')" class="mt-auto w-full text-center font-semibold text-brand-accent hover:underline">
                            Abrir Editor &rarr;
                        </button>
                    </div>

                    <!-- Card de Projeto 8 -->
                    <div class="bg-gray-900/50 border border-gray-800 p-6 rounded-xl card-hover flex flex-col">
                        <div class="mb-3">
                            <span class="text-xs font-semibold px-3 py-1 bg-gray-500/20 text-gray-300 rounded-full">Utilit√°rio</span>
                        </div>
                        <h3 class="text-2xl font-bold mb-3">Lista de Tarefas</h3>
                        <p class="text-gray-400 mb-4 flex-grow">
                            Um "To-Do List" simples que salva suas tarefas no navegador.
                        </p>
                        <button onclick="openProjectModal('todoList')" class="mt-auto w-full text-center font-semibold text-brand-accent hover:underline">
                            Abrir Lista &rarr;
                        </button>
                    </div>

                    <!-- Card de Projeto 9 (MODIFICADO) -->
                    <div class="bg-gray-900/50 border border-gray-800 p-6 rounded-xl card-hover flex flex-col">
                        <div class="mb-3">
                            <span class="text-xs font-semibold px-3 py-1 bg-blue-600/20 text-blue-300 rounded-full">Escrita Criativa (IA)</span>
                        </div>
                        <h3 class="text-2xl font-bold mb-3">Gerador de Hist√≥rias (IA)</h3>
                        <p class="text-gray-400 mb-4 flex-grow">
                            D√™ um tema ou um personagem e a IA escrever√° uma pequena hist√≥ria para voc√™.
                        </p>
                        <button onclick="openProjectModal('storyGenerator')" class="mt-auto w-full text-center font-semibold text-brand-accent hover:underline">
                            Come√ßar a Escrever &rarr;
                        </button>
                    </div>
                    
                    <!-- Card de Projeto 10 -->
                    <div class="bg-gray-900/50 border border-gray-800 p-6 rounded-xl card-hover flex flex-col">
                        <div class="mb-3">
                            <span class="text-xs font-semibold px-3 py-1 bg-green-600/20 text-green-300 rounded-full">Web Game</span>
                        </div>
                        <h3 class="text-2xl font-bold mb-3">Jogo Pong</h3>
                        <p class="text-gray-400 mb-4 flex-grow">
                            O cl√°ssico jogo Pong para dois jogadores (ou um jogador vs. parede).
                        </p>
                        <button onclick="openProjectModal('pongGame')" class="mt-auto w-full text-center font-semibold text-brand-accent hover:underline">
                            Jogar Agora &rarr;
                        </button>
                    </div>

                </div>
            </section>
        </main>

        <!-- Rodap√© -->
        <footer id="contato" class="text-center py-12 border-t border-gray-800">
            <!-- ... (conte√∫do 'footer' existente) ... -->
            <p class="text-gray-400">
                Criado pelo time <span class="font-semibold text-white">Bots Tech</span> para o BatchHacks.
            </p>
            <p class="text-gray-500 text-sm mt-2">
                Apresentado por Batch 09.
            </p>
        </footer>

    </div>

    <!-- 
    ============================================================
    MODAL DO PROJETO
    ============================================================
    -->
    <div id="project-modal" class="fixed inset-0 bg-black/80 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-gray-900 border border-gray-700 w-full max-w-3xl rounded-xl shadow-2xl relative">
            <!-- Bot√£o de Fechar -->
            <button onclick="closeProjectModal()" class="absolute -top-3 -right-3 w-10 h-10 bg-white text-black rounded-full font-bold text-2xl leading-none shadow-lg z-10 hover:bg-gray-200">
                &times;
            </button>
            
            <!-- Conte√∫do do Projeto (ser√° preenchido via JS) -->
            <div id="project-modal-content" class="p-6">
                <!-- O conte√∫do do projeto ativo aparecer√° aqui -->
            </div>
        </div>
    </div>


    <!-- 
    ============================================================
    JAVASCRIPT DAS APLICA√á√ïES
    ============================================================
    -->
    <script>
        // --- 1. CONTROLE DO MODAL ---
        
        const modal = document.getElementById('project-modal');
        const modalContent = document.getElementById('project-modal-content');
        
        // ==========================================================
        // ATEN√á√ÉO: CONFIGURA√á√ÉO DE API KEY PARA TESTE LOCAL
        // ==========================================================
        // Cole sua chave de API do Google AI Studio aqui,
        // APENAS para testar no seu VS Code.
        // NUNCA COMPARTILHE ESSE ARQUIVO COM A CHAVE PREENCHIDA!
        const LOCAL_API_KEY = "AIzaSyCb56B8KX-aUMDchEw2UfVr4Ze7lBI6kn8"; // <-- COLE SUA CHAVE APIza... AQUI
        // ==========================================================


        // --- Vari√°veis Globais dos Jogos ---
        let gameLoopId = null; // Para parar o loop do Space Invaders
        let pongGameLoopId = null; // Para parar o loop do Pong
        
        // Fun√ß√µes para lidar com os listeners do jogo
        const gameKeydownHandler = (e) => spaceInvadersGame.handleKey(e, true);
        const gameKeyupHandler = (e) => spaceInvadersGame.handleKey(e, false);
        // Handler do Pong (movido para o escopo global)
        const pongGameKeyHandler = (e) => {
            if (pongGame && pongGame.keys) pongGame.keys[e.code] = e.type === 'keydown';
        };


        function openProjectModal(projectId) {
            modal.classList.remove('hidden');
            
            // --- C√ìDIGO FALTANTE (INSERIDO AGORA) ---
            // Limpa o conte√∫do anterior
            modalContent.innerHTML = ''; 
            
            // Remove listeners de jogos anteriores
            document.removeEventListener('keydown', gameKeydownHandler);
            document.removeEventListener('keyup', gameKeyupHandler);
            
            // Remove listeners do Pong (keydown E keyup)
            document.removeEventListener('keydown', pongGameKeyHandler);
            document.removeEventListener('keyup', pongGameKeyHandler);
            // Para o loop do Pong
            if (pongGameLoopId) {
                cancelAnimationFrame(pongGameLoopId);
                pongGameLoopId = null;
            }
            // --- FIM DA CORRE√á√ÉO (PARCIAL) ---

            // --- ESTE √â O SWITCH QUE ESTAVA FALTANDO ---
            switch (projectId) {
                case 'sentiment':
                    initSentimentAnalyzer();
                    break;
                case 'aiChartGenerator': 
                    initAiChartGenerator();
                    break;
                case 'spaceInvaders':
                    initSpaceInvaders();
                    break;
                // --- NOVOS CASES ---
                case 'paletteGenerator':
                    initPaletteGenerator();
                    break;
                case 'ticTacToe':
                    initTicTacToe();
                    break;
                case 'forceGraph':
                    initForceGraph();
                    break;
                case 'markdownEditor':
                    initMarkdownEditor();
                    break;
                case 'todoList':
                    initTodoList();
                    break;
                case 'storyGenerator': // MODIFICADO (era 'aiTranslator')
                    initStoryGenerator();
                    break;
                case 'pongGame':
                    initPongGame();
                    break;
            }
            // --- FIM DO SWITCH FALTANTE ---
        }

        // --- ESTA FUN√á√ÉO ESTAVA FALTANDO ---
        function closeProjectModal() {
            modal.classList.add('hidden');
            modalContent.innerHTML = ''; // Limpa o conte√∫do

            // Remove listeners de jogos
            document.removeEventListener('keydown', gameKeydownHandler);
            document.removeEventListener('keyup', gameKeyupHandler);
            
            // --- CORRE√á√ÉO: Parar o loop do Space Invaders ---
            if (gameLoopId) {
                cancelAnimationFrame(gameLoopId);
                gameLoopId = null;
            }
            
            // Remove listeners do Pong (keydown E keyup)
            document.removeEventListener('keydown', pongGameKeyHandler);
            document.removeEventListener('keyup', pongGameKeyHandler);
            // Para o loop do Pong
            if (pongGameLoopId) {
                cancelAnimationFrame(pongGameLoopId);
                pongGameLoopId = null;
            }
        }

        // --- 2. PROJETO 1: ANALISADOR DE SENTIMENTO (IA) ---
        // ESTA FUN√á√ÉO ESTAVA FALTANDO
        function initSentimentAnalyzer() {
            modalContent.innerHTML = `
                <h2 class="text-2xl font-bold mb-4 gradient-text">Analisador de Sentimento (IA)</h2>
                <p class="text-gray-400 mb-4">Digite uma frase para a IA (Gemini) classificar o sentimento.</p>
                <textarea id="sentiment-input" class="w-full h-24 p-3 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-brand-accent focus:ring-0" placeholder="Ex: Estou muito feliz com este hackathon!"></textarea>
                <button onclick="analyzeSentiment()" id="sentiment-button" class="mt-4 bg-brand-accent text-white font-semibold px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                    Analisar
                </button>
                <div id="sentiment-loading" class="hidden mt-4 text-center text-gray-400">
                    <div class="inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-brand-accent"></div>
                    <p class="mt-2">Analisando...</p>
                </div>
                <div id="sentiment-result" class="mt-4 p-4 rounded-lg text-lg font-semibold hidden"></div>
            `;
        }

        async function analyzeSentiment() {
            const text = document.getElementById('sentiment-input').value;
            const resultDiv = document.getElementById('sentiment-result');
            const loadingDiv = document.getElementById('sentiment-loading');
            const button = document.getElementById('sentiment-button');

            if (!text) {
                resultDiv.textContent = 'Por favor, digite uma frase.';
                resultDiv.className = 'mt-4 p-4 rounded-lg text-lg font-semibold bg-red-600/20 text-red-300';
                resultDiv.classList.remove('hidden');
                return;
            }

            loadingDiv.classList.remove('hidden');
            resultDiv.classList.add('hidden');
            button.disabled = true;

            const apiKey = LOCAL_API_KEY; 
            
            // --- NOVA VERIFICA√á√ÉO ---
            if (!apiKey) {
                resultDiv.textContent = 'Erro: API Key n√£o configurada. Adicione sua chave √† vari√°vel LOCAL_API_KEY no c√≥digo.';
                resultDiv.className = 'mt-4 p-4 rounded-lg text-lg font-semibold bg-red-600/20 text-red-300';
                resultDiv.classList.remove('hidden');
                loadingDiv.classList.add('hidden');
                button.disabled = false;
                return;
            }
            // --- FIM DA VERIFICA√á√ÉO ---
            
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            
            // Instru√ß√£o para a IA responder APENAS com uma palavra
            const systemPrompt = "Voc√™ √© um analisador de sentimento. Responda APENAS com uma das tr√™s palavras: 'Positivo', 'Negativo' ou 'Neutro'.";

            const payload = {
                contents: [{ parts: [{ text: text }] }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`Erro da API: ${response.statusText}`);
                }

                const result = await response.json();
                const sentiment = result.candidates[0].content.parts[0].text.trim().toLowerCase();

                resultDiv.classList.remove('hidden', 'bg-green-600/20', 'text-green-300', 'bg-red-600/20', 'text-red-300', 'bg-gray-600/20', 'text-gray-300');

                if (sentiment.includes('positivo')) {
                    resultDiv.textContent = 'Sentimento: Positivo üòÑ';
                    resultDiv.classList.add('bg-green-600/20', 'text-green-300');
                } else if (sentiment.includes('negativo')) {
                    resultDiv.textContent = 'Sentimento: Negativo üòû';
                    resultDiv.classList.add('bg-red-600/20', 'text-red-300');
                } else {
                    resultDiv.textContent = 'Sentimento: Neutro üòê';
                    resultDiv.classList.add('bg-gray-600/20', 'text-gray-300');
                }

            } catch (error) {
                console.error("Erro ao analisar sentimento:", error);
                resultDiv.textContent = 'Erro ao analisar. Tente novamente.';
                resultDiv.className = 'mt-4 p-4 rounded-lg text-lg font-semibold bg-red-600/20 text-red-300';
            } finally {
                loadingDiv.classList.add('hidden');
                resultDiv.classList.remove('hidden');
                button.disabled = false;
            }
        }

        // --- 3. PROJETO 2: CRIADOR DE GR√ÅFICOS (IA) --- (Substituindo o Gr√°fico de Bolhas)

        function initAiChartGenerator() {
            modalContent.innerHTML = `
                <h2 class="text-2xl font-bold mb-4 gradient-text">Criador de Gr√°ficos com IA</h2>
                <p class="text-gray-400 mb-4">Descreva os dados que voc√™ quer visualizar. A IA vai criar um gr√°fico (barra vertical, barra horizontal ou bolhas).</p>
                <textarea id="chart-prompt" class="w-full h-24 p-3 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-brand-accent focus:ring-0" placeholder="Ex: 'Crie um gr√°fico de barras verticais mostrando as vendas: Ma√ß√£s (50), Bananas (80), Laranjas (30)'"></textarea>
                <button onclick="generateChart()" id="chart-button" class="mt-4 bg-brand-accent text-white font-semibold px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                    Gerar Gr√°fico
                </button>
                <div id="chart-loading" class="hidden mt-4 text-center text-gray-400">
                    <div class="inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-brand-accent"></div>
                    <p class="mt-2">Gerando visualiza√ß√£o...</p>
                </div>
                <div id="chart-error" class="mt-4 p-4 rounded-lg text-lg font-semibold hidden"></div>
                <div id="chart-container" class="w-full min-h-[450px] mt-6">
                    <!-- O gr√°fico gerado pela IA aparecer√° aqui -->
                </div>
            `;
        }

        async function generateChart() {
            const prompt = document.getElementById('chart-prompt').value;
            const errorDiv = document.getElementById('chart-error');
            const loadingDiv = document.getElementById('chart-loading');
            const button = document.getElementById('chart-button');
            const chartContainer = document.getElementById('chart-container');

            if (!prompt) {
                errorDiv.textContent = 'Por favor, digite uma descri√ß√£o para o gr√°fico.';
                errorDiv.className = 'mt-4 p-4 rounded-lg text-lg font-semibold bg-red-600/20 text-red-300';
                errorDiv.classList.remove('hidden');
                return;
            }

            loadingDiv.classList.remove('hidden');
            errorDiv.classList.add('hidden');
            chartContainer.innerHTML = ''; // Limpa o gr√°fico anterior
            button.disabled = true;

            const apiKey = LOCAL_API_KEY; 
            
            // --- NOVA VERIFICA√á√ÉO ---
            if (!apiKey) {
                errorDiv.textContent = 'Erro: API Key n√£o configurada. Adicione sua chave √† vari√°vel LOCAL_API_KEY no c√≥digo.';
                errorDiv.className = 'mt-4 p-4 rounded-lg text-lg font-semibold bg-red-600/20 text-red-300';
                errorDiv.classList.remove('hidden');
                loadingDiv.classList.add('hidden');
                button.disabled = false;
                return;
            }
            // --- FIM DA VERIFICA√á√ÉO ---

            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

            // 1. O Schema JSON que a IA DEVE retornar
            const responseSchema = {
                "type": "OBJECT",
                "properties": {
                    "chartType": { 
                        "type": "STRING", 
                        "enum": ["bar", "barh", "bubble"],
                        "description": "Use 'bar' para vertical, 'barh' para horizontal, 'bubble' para bolhas."
                    },
                    "title": { "type": "STRING", "description": "Um t√≠tulo para o gr√°fico." },
                    "data": {
                        "type": "ARRAY",
                        "items": {
                            "type": "OBJECT",
                            "properties": {
                                "label": { "type": "STRING" },
                                "value": { "type": "NUMBER" }
                            }
                        }
                    }
                },
                "required": ["chartType", "title", "data"]
            };

            // 2. Instru√ß√µes para a IA
            const systemPrompt = `Voc√™ √© um assistente de visualiza√ß√£o de dados. O usu√°rio fornecer√° uma descri√ß√£o em linguagem natural.
Sua tarefa √©:
1. Analisar o pedido.
2. Se os dados n√£o forem fornecidos, invente dados de exemplo apropriados (pelo menos 4-5 pontos de dados).
3. Mapear os tipos de gr√°fico: 'gr√°fico vertical' ou 'gr√°fico de barras' -> 'bar'. 'gr√°fico horizontal' -> 'barh'. 'gr√°fico de bolhas' -> 'bubble'.
4. Formatar a sa√≠da estritamente de acordo com o JSON schema fornecido.`;

            // 3. Payload da API
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: responseSchema
                }
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`Erro da API: ${response.statusText}`);
                }

                const result = await response.json();
                
                if (!result.candidates || !result.candidates[0].content.parts[0].text) {
                     throw new Error('Resposta da IA inv√°lida.');
                }

                const jsonText = result.candidates[0].content.parts[0].text;
                const chartData = JSON.parse(jsonText);

                // 4. Desenhar o gr√°fico com os dados da IA
                drawAiChart(chartData);

            } catch (error) {
                console.error("Erro ao gerar gr√°fico:", error);
                errorDiv.textContent = `Erro ao gerar gr√°fico: ${error.message}. Tente novamente.`;
                errorDiv.className = 'mt-4 p-4 rounded-lg text-lg font-semibold bg-red-600/20 text-red-300';
                errorDiv.classList.remove('hidden');
            } finally {
                loadingDiv.classList.add('hidden');
                button.disabled = false;
            }
        }

        // Fun√ß√£o "roteadora" que decide qual gr√°fico desenhar
        function drawAiChart(chartData) {
            const container = document.getElementById('chart-container');
            container.innerHTML = ''; // Limpa de novo por seguran√ßa

            // Adiciona o t√≠tulo
            const title = document.createElement('h3');
            title.className = 'text-xl font-semibold text-white text-center mb-4';
            title.textContent = chartData.title;
            container.appendChild(title);
            
            // Adiciona o SVG
            const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            svg.id = "ai-chart-svg";
            container.appendChild(svg);

            // Chama a fun√ß√£o D3 correta
            switch (chartData.chartType) {
                case 'bar':
                    drawBarChart(chartData.data, false); // false = vertical
                    break;
                case 'barh':
                    drawBarChart(chartData.data, true); // true = horizontal
                    break;
                case 'bubble':
                    drawBubbleChart_AI(chartData.data);
                    break;
                default:
                    container.innerHTML = `<p class="text-red-400">Tipo de gr√°fico desconhecido: ${chartData.chartType}</p>`;
            }
        }
        
        // --- 10. PROJETO 9: TRADUTOR COM IA (IA) ---
        // ESTA SE√á√ÉO FOI REMOVIDA E SUBSTITU√çDA ABAIXO
        
        // --- 10. PROJETO 9: GERADOR DE HIST√ìRIAS (NOVO) ---
        
        function initStoryGenerator() {
             modalContent.innerHTML = `
                <h2 class="text-2xl font-bold mb-4 gradient-text">Gerador de Hist√≥rias (IA)</h2>
                <p class="text-gray-400 mb-4">D√™ um prompt para a IA (ex: "um cavaleiro que tem medo de cavalos").</p>
                
                <textarea id="story-prompt" class="w-full h-24 p-3 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-brand-accent focus:ring-0" placeholder="Digite seu prompt criativo aqui..."></textarea>

                <button onclick="generateStory()" id="story-button" class="mt-4 bg-brand-accent text-white font-semibold px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                    Gerar Hist√≥ria
                </button>
                
                <div id="story-loading" class="hidden mt-4 text-center text-gray-400">
                    <div class="inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-brand-accent"></div>
                    <p class="mt-2">Escrevendo...</p>
                </div>
                <div id="story-error" class="mt-4 p-4 rounded-lg text-lg font-semibold hidden"></div>
                
                <div id="story-output" class="w-full mt-6 p-4 rounded-lg bg-gray-950 border border-gray-700 min-h-[200px] text-gray-300 whitespace-pre-line hidden">
                    <!-- A hist√≥ria gerada aparecer√° aqui -->
                </div>
            `;
        }
        
        async function generateStory() {
            const prompt = document.getElementById('story-prompt').value;
            const errorDiv = document.getElementById('story-error');
            const loadingDiv = document.getElementById('story-loading');
            const button = document.getElementById('story-button');
            const outputArea = document.getElementById('story-output');

            if (!prompt) {
                errorDiv.textContent = 'Por favor, digite um prompt para a hist√≥ria.';
                errorDiv.className = 'mt-4 p-4 rounded-lg text-lg font-semibold bg-red-600/20 text-red-300';
                errorDiv.classList.remove('hidden');
                return;
            }

            loadingDiv.classList.remove('hidden');
            errorDiv.classList.add('hidden');
            outputArea.classList.add('hidden');
            outputArea.innerHTML = '';
            button.disabled = true;

            const apiKey = LOCAL_API_KEY; 
            
            if (!apiKey) {
                errorDiv.textContent = 'Erro: API Key n√£o configurada. Adicione sua chave √† vari√°vel LOCAL_API_KEY no c√≥digo.';
                errorDiv.className = 'mt-4 p-4 rounded-lg text-lg font-semibold bg-red-600/20 text-red-300';
                errorDiv.classList.remove('hidden');
                loadingDiv.classList.add('hidden');
                button.disabled = false;
                return;
            }

            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

            const systemPrompt = `Voc√™ √© um escritor criativo. O usu√°rio fornecer√° um prompt. 
Escreva uma pequena hist√≥ria (cerca de 3-4 par√°grafos) baseada nesse prompt.
Responda APENAS com a hist√≥ria, sem introdu√ß√µes ou coment√°rios.`;
            
             const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                if (!response.ok) {
                    throw new Error(`Erro da API: ${response.status} ${response.statusText}`);
                }

                const result = await response.json();
                
                if (result.candidates && result.candidates[0]?.content?.parts[0]?.text) {
                    let storyText = result.candidates[0].content.parts[0].text;
                    // Converte quebras de linha (\n) em tags <br> para formata√ß√£o HTML
                    storyText = storyText.replace(/\n/g, '<br>');
                    
                    outputArea.innerHTML = storyText;
                    outputArea.classList.remove('hidden');
                } else {
                    throw new Error('Resposta da API inv√°lida.');
                }

            } catch (error) {
                console.error("Erro ao gerar hist√≥ria:", error);
                errorDiv.textContent = `Erro ao gerar hist√≥ria: ${error.message}.`;
                errorDiv.className = 'mt-4 p-4 rounded-lg text-lg font-semibold bg-red-600/20 text-red-300';
                errorDiv.classList.remove('hidden');
            } finally {
                loadingDiv.classList.add('hidden');
                button.disabled = false;
            }
        }

        // --- 11. PROJETO 10: JOGO PONG ---
        
        let pongGame = {};
        // IDs dos loops e handlers agora s√£o globais
        // let pongGameLoopId = null; 
        // const pongGameKeyHandler = (e) => { ... }; 

        function initPongGame() {
            modalContent.innerHTML = `
                <h2 class="text-2xl font-bold mb-4 gradient-text">Jogo Pong</h2>
                <div class="flex justify-center items-center mb-2 text-2xl font-bold">
                    <p class="text-white"><span id="pong-score1">0</span> - <span id="pong-score2">0</span></p>
                </div>
                <canvas id="pong-canvas" width="600" height="400"></canvas>
                <p class="text-gray-500 text-sm text-center mt-2">Jogador 1 (Esquerda): W (cima) e S (baixo).</p>
                 <p class="text-gray-500 text-sm text-center">Jogador 2 (Direita): Seta Cima (‚Üë) e Seta Baixo (‚Üì).</p>
            `;
            
            const canvas = document.getElementById('pong-canvas');
            const ctx = canvas.getContext('2d');
            const score1El = document.getElementById('pong-score1');
            const score2El = document.getElementById('pong-score2');

            pongGame = {
                canvas, ctx, score1El, score2El,
                width: canvas.width,
                height: canvas.height,
                keys: {},
                ball: { x: canvas.width / 2, y: canvas.height / 2, r: 8, dx: 5, dy: 3 },
                p1: { x: 10, y: canvas.height / 2 - 40, w: 15, h: 80, speed: 7, score: 0 },
                p2: { x: canvas.width - 25, y: canvas.height / 2 - 40, w: 15, h: 80, speed: 7, score: 0 },
                
                resetBall: (direction) => {
                    pongGame.ball.x = pongGame.width / 2;
                    pongGame.ball.y = pongGame.height / 2;
                    pongGame.ball.dx = 5 * direction; // Bola vai para quem marcou
                    pongGame.ball.dy = (Math.random() * 6) - 3; // √Çngulo aleat√≥rio
                },
                
                draw: () => {
                    const { ctx, width, height, ball, p1, p2 } = pongGame;
                    // Fundo
                    ctx.fillStyle = '#000';
                    ctx.fillRect(0, 0, width, height);
                    
                    // Linha do meio
                    ctx.fillStyle = '#333';
                    ctx.fillRect(width / 2 - 1, 0, 2, height);
                    
                    // Bola
                    ctx.fillStyle = '#fff';
                    ctx.beginPath();
                    ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Raquete 1 (Esquerda)
                    ctx.fillStyle = '#3B82F6';
                    ctx.fillRect(p1.x, p1.y, p1.w, p1.h);
                    
                    // Raquete 2 (Direita)
                    ctx.fillStyle = '#10B981';
                    ctx.fillRect(p2.x, p2.y, p2.w, p2.h);
                },
                
                update: () => {
                    const { keys, ball, p1, p2, width, height } = pongGame;
                    
                    // Mover Raquete 1 (W/S)
                    if (keys['KeyW'] && p1.y > 0) p1.y -= p1.speed;
                    if (keys['KeyS'] && p1.y < height - p1.h) p1.y += p1.speed;
                    
                    // Mover Raquete 2 (Cima/Baixo)
                    if (keys['ArrowUp'] && p2.y > 0) p2.y -= p2.speed;
                    if (keys['ArrowDown'] && p2.y < height - p2.h) p2.y += p2.speed;
                    
                    // Mover Bola
                    ball.x += ball.dx;
                    ball.y += ball.dy;
                    
                    // Colis√£o com paredes (Cima/Baixo)
                    if (ball.y - ball.r < 0) {
                        ball.y = ball.r;
                        ball.dy *= -1;
                    }
                    if (ball.y + ball.r > height) {
                        ball.y = height - ball.r;
                        ball.dy *= -1;
                    }
                    
                    // Colis√£o com Raquete 1 (Esquerda)
                    if (ball.x - ball.r < p1.x + p1.w && 
                        ball.y > p1.y && ball.y < p1.y + p1.h) {
                        ball.x = p1.x + p1.w + ball.r;
                        ball.dx *= -1.1; // Aumenta velocidade
                    }
                    
                    // Colis√£o com Raquete 2 (Direita)
                    if (ball.x + ball.r > p2.x &&
                        ball.y > p2.y && ball.y < p2.y + p2.h) {
                        ball.x = p2.x - ball.r;
                        ball.dx *= -1.1; // Aumenta velocidade
                    }
                    
                    // Ponto (Bola saiu)
                    if (ball.x - ball.r < 0) { // Ponto para P2
                        p2.score++;
                        pongGame.resetBall(1);
                    }
                    if (ball.x + ball.r > width) { // Ponto para P1
                        p1.score++;
                        pongGame.resetBall(-1);
                    }
                    
                    // Atualiza UI
                    score1El.textContent = p1.score;
                    score2El.textContent = p2.score;
                },
                
                loop: () => {
                    pongGame.update();
                    pongGame.draw();
                    pongGameLoopId = requestAnimationFrame(pongGame.loop);
                }
            };
            
            // Adiciona listeners
            document.addEventListener('keydown', pongGameKeyHandler);
            document.addEventListener('keyup', pongGameKeyHandler);
            
            // Inicia o jogo
            pongGame.resetBall(1);
            pongGame.loop();
        }
        
    </script>

</body>
</html>
